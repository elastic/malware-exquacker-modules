import logging

from malduck.extractor import Extractor

logger = logging.getLogger(__name__)


class CobaltStrike(Extractor):
    family = "cobalt_strike"
    yara_rules = ("cobalt_strike",)
    overrides = ["zeus"] # todo: what does this mean?

    @Extractor.extractor("briankerbs") # todo: why is this here?
    def cobalt_strike_found(self, p, addr):
        logger.info("[+] `Coded by Brian Krebs` str @ %X" % addr)
        return {"family": "cobalt_strike"}

    @Extractor.extractor
    def cobalt_salt(self, p, addr):
        salt = p.uint32v(addr - 8)
        logger.info("[+] Found salt @ %X - %x" % (addr, salt))
        return {"salt": salt}