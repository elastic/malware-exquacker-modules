import logging

from malduck.extractor import Extractor

logger = logging.getLogger(__name__)


class Citadel(Extractor):
    family = "citadel"
    yara_rules = ("citadel",)
    overrides = ["zeus"]

    @Extractor.extractor("briankerbs")
    def citadel_found(self, p, addr):
        logger.info("[+] `Coded by Brian Krebs` str @ %X" % addr)
        return {"family": "citadel"}

    @Extractor.extractor
    def cit_salt(self, p, addr):
        salt = p.uint32v(addr - 8)
        logger.info("[+] Found salt @ %X - %x" % (addr, salt))
        return {"salt": salt}
